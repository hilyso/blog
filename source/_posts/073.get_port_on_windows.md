---
title: Windows 获取当前监听的端口
date: 2024-1-29 15:08:11
categories: 
- [DevOps]
tags: 
- bat批处理
---


## 仅限 tcp 端口

**参数说明:**

- ```:%%p```  :139  避免长短号中间包含139
- ``` errorlevel 1 ``` 判断命令执行的返回
- bat同级目录输出文件

``` bat
@echo off
setlocal enabledelayedexpansion

set "ports=21 22 23 25 53 69 110 135 139 143 161 389 445 873 1025 111"

for %%p in (%ports%) do (
    netstat -ano | findstr LISTEN | findstr :%%p >null
    if errorlevel 1 (
        echo Port %%p is not listening.
    ) else (
        echo Port %%p is listening.
        echo %%p >> output.txt
    )
)
pause

```